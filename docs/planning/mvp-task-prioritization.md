# MVP Task Prioritization Strategy

**Fecha**: 11 de Enero, 2025 **Versi√≥n**: 1.0 **Proyecto**: Adyela Health System

---

## üìã Resumen Ejecutivo

Basado en el an√°lisis de costos de compliance HIPAA, este documento clasifica
todas las tareas del proyecto en **cr√≠ticas para MVP** vs **opcionales para
post-MVP**.

**Conclusi√≥n clave**: Podemos implementar un MVP con infraestructura HIPAA-Ready
por solo **$1.20/mes adicionales**, postponiendo √∫nicamente 2 componentes
costosos hasta tener usuarios reales procesando PHI.

---

## üéØ Estrategia de MVP

### Principios Gu√≠a

1. ‚úÖ **Implementar infraestructura HIPAA-Ready desde el inicio** (costo m√≠nimo:
   $1.20/mes)
2. ‚è∏Ô∏è **Postponer solo 2 componentes**: CMEK y Cloud Armor WAF (costo:
   $5.29/mes)
3. üöÄ **Priorizar features core** sobre features avanzadas
4. üìä **Validar product-market fit** antes de escalar
5. üí∞ **Mantener costos bajo $5/mes** durante MVP

---

## üèóÔ∏è Infraestructura: Cr√≠tico vs Opcional

### ‚úÖ CR√çTICO - Implementar en MVP (Costo: $1.20/mes)

Estas 12 tareas de infraestructura deben implementarse para el MVP:

#### 1. **VPC y Networking** - $0.00/mes (FREE)

**Prioridad**: P0 - Bloqueante **Justificaci√≥n**: Base de toda la seguridad y
aislamiento de red **Tiempo estimado**: 2-3 horas **Tareas**:

- Crear VPC dedicada para Adyela
- Configurar subnets privadas
- Establecer Cloud NAT para salida controlada
- Configurar Cloud DNS privado

#### 2. **Identity Platform (Firebase Auth)** - $0.00/mes (FREE hasta 50K MAU)

**Prioridad**: P0 - Bloqueante **Justificaci√≥n**: Autenticaci√≥n segura es
obligatoria para cualquier sistema con PHI **Tiempo estimado**: 4-6 horas
**Tareas**:

- Configurar Identity Platform
- Implementar MFA (Multi-Factor Authentication)
- Configurar pol√≠ticas de password
- Implementar rate limiting

#### 3. **API Gateway** - $0.45/mes

**Prioridad**: P0 - Bloqueante **Justificaci√≥n**: Control de acceso centralizado
y rate limiting **Tiempo estimado**: 3-4 horas **Tareas**:

- Configurar API Gateway
- Implementar rate limiting (10K requests/mes)
- Configurar CORS policies
- Establecer API versioning

#### 4. **Cloud Run (Backend API)** - Incluido en costo base

**Prioridad**: P0 - Bloqueante **Justificaci√≥n**: Runtime de la aplicaci√≥n
backend **Tiempo estimado**: Ya implementado, solo configuraci√≥n HIPAA
**Tareas**:

- Configurar service account con permisos m√≠nimos
- Habilitar Cloud Run VPC connector
- Configurar health checks
- Establecer autoscaling limits (1-10 instancias)

#### 5. **Firestore** - $0.18/mes

**Prioridad**: P0 - Bloqueante **Justificaci√≥n**: Base de datos para la
aplicaci√≥n **Tiempo estimado**: 2-3 horas **Tareas**:

- Configurar Firestore en modo privado (VPC)
- Implementar reglas de seguridad granulares
- Configurar √≠ndices optimizados
- Establecer backups autom√°ticos

#### 6. **Cloud Storage** - $0.13/mes

**Prioridad**: P1 - Alta **Justificaci√≥n**: Almacenamiento de archivos y
documentos **Tiempo estimado**: 2-3 horas **Tareas**:

- Configurar buckets con acceso privado
- Implementar signed URLs para acceso temporal
- Configurar lifecycle policies
- Establecer CORS si es necesario

#### 7. **VPC Service Controls** - $0.00/mes (FREE)

**Prioridad**: P0 - Bloqueante **Justificaci√≥n**: Previene exfiltraci√≥n de datos
(requisito HIPAA cr√≠tico) **Tiempo estimado**: 3-4 horas **Tareas**:

- Crear perimeter de seguridad
- Configurar pol√≠ticas de ingress/egress
- Restringir acceso a servicios GCP desde dentro del perimeter
- Configurar access levels

#### 8. **Secret Manager** - $0.24/mes

**Prioridad**: P0 - Bloqueante **Justificaci√≥n**: Manejo seguro de credenciales
(ya en uso parcialmente) **Tiempo estimado**: 1-2 horas (configuraci√≥n
adicional) **Tareas**:

- Migrar todas las secrets a Secret Manager
- Configurar versionamiento autom√°tico
- Implementar rotation policies
- Configurar acceso basado en service accounts

#### 9. **Cloud Monitoring + Logging** - $0.00/mes (FREE hasta 50GB/mes)

**Prioridad**: P0 - Bloqueante **Justificaci√≥n**: Audit logging es requisito
obligatorio HIPAA **Tiempo estimado**: 3-4 horas **Tareas**:

- Configurar Data Access Audit Logs
- Implementar log sinks para retenci√≥n >7 a√±os
- Crear dashboards de monitoreo
- Configurar alertas cr√≠ticas

#### 10. **Audit Logging espec√≠fico para PHI** - $0.00/mes (FREE)

**Prioridad**: P0 - Bloqueante **Justificaci√≥n**: Obligatorio por HIPAA Security
Rule **Tiempo estimado**: 4-6 horas **Tareas**:

- Implementar logging de todos los accesos a PHI
- Capturar: user_id, patient_id, action, timestamp, reason
- Configurar tamper-proof storage (Cloud Storage Bucket locked)
- Implementar retention de 7 a√±os m√≠nimo

#### 11. **IAM Policies (Least Privilege)** - $0.00/mes (FREE)

**Prioridad**: P0 - Bloqueante **Justificaci√≥n**: Principio de m√≠nimo privilegio
(HIPAA Security Rule) **Tiempo estimado**: 3-4 horas **Tareas**:

- Crear service accounts por servicio
- Implementar RBAC granular
- Eliminar permisos de Owner/Editor
- Documentar matriz de permisos

#### 12. **TLS 1.3 en todas las comunicaciones** - $0.00/mes (FREE)

**Prioridad**: P0 - Bloqueante **Justificaci√≥n**: Encriptaci√≥n en tr√°nsito
(HIPAA Security Rule) **Tiempo estimado**: 1-2 horas **Tareas**:

- Configurar Cloud Run con TLS 1.3 m√≠nimo
- Implementar HTTPS-only en API Gateway
- Configurar certificados SSL/TLS autom√°ticos
- Verificar cipher suites seguras

**Total Costo MVP Infraestructura Cr√≠tica: $1.00/mes** **Tiempo Total Estimado:
28-41 horas**

---

### ‚è∏Ô∏è OPCIONAL - Postponer hasta Post-MVP (Costo: $5.29/mes)

Estas 2 tareas se activan cuando hay usuarios reales procesando PHI:

#### 13. **CMEK (Customer-Managed Encryption Keys)** - $0.12/mes

**Prioridad**: P2 - Media (activar con primeros 100 usuarios) **Justificaci√≥n**:
Google-managed encryption es suficiente para MVP **Cu√°ndo activar**: Al tener
primeros 100 usuarios activos o primeros contratos enterprise **Tiempo de
activaci√≥n**: 2-3 horas **Tareas**:

- Crear key ring en Cloud KMS
- Configurar rotation autom√°tica (90 d√≠as)
- Aplicar CMEK a Firestore y Cloud Storage
- Actualizar service accounts con permisos de encryptDecrypt

#### 14. **Cloud Armor WAF** - $5.17/mes

**Prioridad**: P2 - Media (activar con tr√°fico real) **Justificaci√≥n**: Rate
limiting en API Gateway es suficiente para MVP **Cu√°ndo activar**: Al superar
10K requests/d√≠a o detectar primeros ataques **Tiempo de activaci√≥n**: 3-4 horas
**Tareas**:

- Configurar Cloud Armor en API Gateway
- Implementar reglas OWASP Top 10
- Configurar rate limiting avanzado
- Establecer geo-blocking si es necesario

**Total Costo Infraestructura Opcional: $5.29/mes** **Tiempo Total Activaci√≥n:
5-7 horas**

---

## üöÄ Features de Aplicaci√≥n: Cr√≠tico vs Opcional

### ‚úÖ CR√çTICO - MVP Core Features

#### **Core Feature 1: Autenticaci√≥n y Registro**

**Prioridad**: P0 - Bloqueante **User Stories**:

- ‚úÖ Como paciente, quiero registrarme con email/password
- ‚úÖ Como paciente, quiero hacer login con MFA
- ‚úÖ Como doctor, quiero acceder con credenciales organizacionales
- ‚úÖ Como usuario, quiero recuperar mi contrase√±a

**Estado actual**: ‚úÖ Implementado (E2E tests: 16/16 passing)

#### **Core Feature 2: Gesti√≥n de Citas**

**Prioridad**: P0 - Bloqueante **User Stories**:

- ‚úÖ Como paciente, quiero ver citas disponibles
- ‚úÖ Como paciente, quiero agendar una cita
- ‚úÖ Como paciente, quiero cancelar una cita
- ‚úÖ Como doctor, quiero ver mi agenda del d√≠a
- ‚úÖ Como doctor, quiero confirmar/rechazar citas

**Estado actual**: ‚úÖ Implementado parcialmente (core funcionalidad lista)

#### **Core Feature 3: Videoconsultas**

**Prioridad**: P0 - Bloqueante (diferenciador clave) **User Stories**:

- ‚úÖ Como paciente, quiero unirme a videollamada a la hora de mi cita
- ‚úÖ Como doctor, quiero iniciar videoconsulta con paciente
- ‚ö†Ô∏è Como usuario, quiero que la llamada sea segura y encriptada

**Estado actual**: ‚ö†Ô∏è Jitsi integrado, falta validaci√≥n HIPAA de la
implementaci√≥n

**Tareas pendientes**:

- Verificar que Jitsi est√© en modo self-hosted (no usar servidores p√∫blicos)
- Implementar end-to-end encryption (E2EE)
- Configurar recording HIPAA-compliant si es necesario
- Agregar audit logging de sesiones de video

**Tiempo estimado**: 6-8 horas

#### **Core Feature 4: Perfil de Paciente (M√≠nimo)**

**Prioridad**: P0 - Bloqueante **User Stories**:

- ‚úÖ Como paciente, quiero ver mis datos personales
- ‚úÖ Como paciente, quiero editar mi informaci√≥n de contacto
- ‚ö†Ô∏è Como paciente, quiero ver el historial de mis citas

**Estado actual**: ‚úÖ Implementado b√°sico

#### **Core Feature 5: Dashboard de Doctor**

**Prioridad**: P0 - Bloqueante **User Stories**:

- ‚úÖ Como doctor, quiero ver lista de pacientes del d√≠a
- ‚úÖ Como doctor, quiero acceder r√°pidamente a citas pr√≥ximas
- ‚ö†Ô∏è Como doctor, quiero ver alertas de citas pendientes de confirmar

**Estado actual**: ‚úÖ Implementado b√°sico

---

### ‚è∏Ô∏è OPCIONAL - Post-MVP Features

#### **Feature Avanzada 1: Recetas M√©dicas (Prescriptions)**

**Prioridad**: P1 - Alta (post-MVP) **Justificaci√≥n**: Aumenta complejidad legal
y requiere integraci√≥n con farmacias **Cu√°ndo implementar**: Despu√©s de validar
PMF con features core **User Stories**:

- Como doctor, quiero generar receta digital
- Como paciente, quiero ver mis recetas activas
- Como farmacia, quiero validar recetas

**Tiempo estimado**: 20-30 horas **Dependencias**: Integraci√≥n con sistema de
farmacias, validaci√≥n legal

#### **Feature Avanzada 2: Historial M√©dico Completo (EMR)**

**Prioridad**: P1 - Alta (post-MVP) **Justificaci√≥n**: Requiere compliance
adicional y estructura de datos compleja **Cu√°ndo implementar**: Despu√©s de 6
meses con MVP en producci√≥n **User Stories**:

- Como doctor, quiero registrar notas de consulta estructuradas
- Como paciente, quiero ver mi historial m√©dico completo
- Como especialista, quiero importar historial de otros proveedores

**Tiempo estimado**: 40-60 horas **Dependencias**: FHIR compliance,
interoperabilidad HL7

#### **Feature Avanzada 3: Laboratorios e Im√°genes**

**Prioridad**: P2 - Media (futuro) **Justificaci√≥n**: Requiere integraciones
externas y storage costoso **Cu√°ndo implementar**: Fase 2 (a√±o 2) **User
Stories**:

- Como doctor, quiero solicitar ex√°menes de laboratorio
- Como paciente, quiero ver resultados de mis ex√°menes
- Como doctor, quiero visualizar im√°genes m√©dicas (DICOM)

**Tiempo estimado**: 60-80 horas **Costo adicional**: Storage de im√°genes DICOM
(~$2-5/mes adicionales)

#### **Feature Avanzada 4: Pagos y Facturaci√≥n**

**Prioridad**: P1 - Alta (post-MVP) **Justificaci√≥n**: Requiere integraci√≥n con
payment gateway y complejidad fiscal **Cu√°ndo implementar**: Despu√©s de validar
modelo de negocio **User Stories**:

- Como paciente, quiero pagar consultas con tarjeta
- Como cl√≠nica, quiero generar facturas autom√°ticas
- Como administrador, quiero reportes financieros

**Tiempo estimado**: 30-40 horas **Costo adicional**: Payment gateway fees
(Stripe ~2.9% + $0.30)

#### **Feature Avanzada 5: Multi-idioma Completo**

**Prioridad**: P2 - Media (futuro) **Justificaci√≥n**: MVP funciona con ES/EN
**Cu√°ndo implementar**: Al expandir a nuevos mercados **Tiempo estimado**: 15-20
horas

---

## üìä Resumen de Priorizaci√≥n

### MVP Scope (Fase 0: Meses 1-3)

**Infraestructura**:

- ‚úÖ 12 componentes HIPAA-Ready (costo: $1.20/mes)
- ‚è∏Ô∏è 2 componentes postponer (CMEK, Cloud Armor)

**Features**:

- ‚úÖ Autenticaci√≥n + MFA
- ‚úÖ Gesti√≥n de citas
- ‚ö†Ô∏è Videoconsultas (requiere validaci√≥n HIPAA)
- ‚úÖ Perfil b√°sico de paciente
- ‚úÖ Dashboard b√°sico de doctor

**Tiempo total estimado MVP**: 35-50 horas **Costo mensual MVP**: $3.20/mes
($2.00 base + $1.20 HIPAA)

### Post-MVP Scope (Fase 1: Meses 4-9)

**Infraestructura**:

- Activar CMEK cuando se alcancen 100 usuarios (+$0.12/mes)
- Activar Cloud Armor WAF cuando se superen 10K req/d√≠a (+$5.17/mes)

**Features**:

- Recetas m√©dicas
- Pagos y facturaci√≥n
- Historial m√©dico expandido

**Tiempo estimado Fase 1**: 50-70 horas **Costo mensual Fase 1**: $8.49/mes

---

## üéØ Plan de Implementaci√≥n MVP

### Sprint 1: Infraestructura HIPAA-Ready (Semana 1-2)

**Objetivos**:

- Implementar 12 componentes de infraestructura cr√≠ticos
- Costo objetivo: $1.20/mes adicionales

**Tasks**:

1. ‚úÖ VPC + Networking (2-3h)
2. ‚úÖ Identity Platform configuraci√≥n avanzada (4-6h)
3. ‚úÖ API Gateway (3-4h)
4. ‚úÖ Cloud Run con VPC connector (2-3h)
5. ‚úÖ Firestore en modo privado (2-3h)
6. ‚úÖ Cloud Storage seguro (2-3h)
7. ‚úÖ VPC Service Controls (3-4h)
8. ‚úÖ Secret Manager completo (1-2h)
9. ‚úÖ Cloud Monitoring + Logging (3-4h)
10. ‚úÖ Audit Logging PHI (4-6h)
11. ‚úÖ IAM Policies (3-4h)
12. ‚úÖ TLS 1.3 enforcement (1-2h)

**Deliverables**:

- Infraestructura desplegada en staging
- Documentaci√≥n de configuraci√≥n
- Tests de seguridad pasando
- Costo verificado ‚â§ $5/mes

### Sprint 2: Validaci√≥n HIPAA de Features (Semana 3)

**Objetivos**:

- Validar que features core cumplan HIPAA
- Completar audit logging en toda la aplicaci√≥n

**Tasks**:

1. Validar Jitsi self-hosted con E2EE (6-8h)
2. Implementar audit logging en todos los endpoints que acceden PHI (8-10h)
3. Agregar tests de seguridad para PHI access (4-6h)
4. Documentar flujos de datos sensibles (3-4h)

**Deliverables**:

- Videoconsultas HIPAA-compliant
- 100% de accesos a PHI loggeados
- Documentaci√≥n de compliance actualizada

### Sprint 3: Testing y Deployment (Semana 4)

**Objetivos**:

- Ejecutar full testing suite
- Desplegar a staging con infraestructura HIPAA-Ready

**Tasks**:

1. E2E tests completos (verificar 16/16 passing)
2. Security audit con Bandit + npm audit
3. Lighthouse audit (target: Performance 90+)
4. Deployment a staging
5. Smoke tests en staging

**Deliverables**:

- MVP desplegado en staging
- Todos los tests en verde
- Costo real medido

---

## üí∞ An√°lisis de Costos por Fase

### Fase 0: MVP (Mes 1-3)

```
Base Infrastructure:      $2.00/mes
HIPAA-Ready Components:   $1.20/mes
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Total:                    $3.20/mes
```

### Fase 1: Early Growth (Mes 4-9, 100-1000 usuarios)

```
Base Infrastructure:      $2.00/mes
HIPAA-Ready Components:   $1.20/mes
CMEK (activado):          $0.12/mes
Cloud Armor (activado):   $5.17/mes
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Total:                    $8.49/mes
```

### Fase 2: Scale (Mes 10-18, 1K-10K usuarios)

```
Base Infrastructure:      $5.00/mes (scaled)
HIPAA-Ready Components:   $2.50/mes (scaled)
CMEK:                     $0.24/mes (scaled)
Cloud Armor:             $12.00/mes (scaled)
Image Storage:            $5.00/mes (new)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Total:                   $24.74/mes
```

---

## ‚úÖ Recomendaci√≥n Final

### Decisi√≥n: **Implementar MVP con Infraestructura HIPAA-Ready**

**Razones**:

1. ‚úÖ **Costo m√≠nimo**: Solo $1.20/mes adicionales (incremental cost de 60%)
2. ‚úÖ **Evita migraci√≥n futura**: Implementar HIPAA despu√©s es 10x m√°s costoso
   en tiempo
3. ‚úÖ **Compliance desde d√≠a 1**: Podemos aceptar clientes healthcare
   inmediatamente
4. ‚úÖ **Diferenciador competitivo**: La mayor√≠a de MVPs no son HIPAA-compliant
5. ‚úÖ **Tiempo de activaci√≥n r√°pido**: Solo 35-50 horas de implementaci√≥n
6. ‚úÖ **Escalabilidad**: Solo activar CMEK y Cloud Armor cuando sea necesario

**Componentes a postponer**:

- ‚è∏Ô∏è CMEK (Customer-Managed Encryption Keys): $0.12/mes
- ‚è∏Ô∏è Cloud Armor WAF: $5.17/mes

**Features a postponer**:

- ‚è∏Ô∏è Recetas m√©dicas
- ‚è∏Ô∏è EMR completo
- ‚è∏Ô∏è Laboratorios e im√°genes
- ‚è∏Ô∏è Pagos y facturaci√≥n
- ‚è∏Ô∏è Multi-idioma avanzado

---

## üìã Checklist de Aceptaci√≥n MVP

### Infraestructura (12/14 componentes)

- [ ] VPC configurada con subnets privadas
- [ ] Identity Platform con MFA activo
- [ ] API Gateway con rate limiting
- [ ] Cloud Run con VPC connector
- [ ] Firestore en modo privado
- [ ] Cloud Storage con acceso restringido
- [ ] VPC Service Controls activo
- [ ] Secret Manager con todas las secrets
- [ ] Cloud Monitoring configurado
- [ ] Audit Logging PHI implementado
- [ ] IAM Policies con least privilege
- [ ] TLS 1.3 enforced
- ‚è∏Ô∏è CMEK (postponer)
- ‚è∏Ô∏è Cloud Armor (postponer)

### Features Core

- [ ] Autenticaci√≥n con MFA funcional
- [ ] Gesti√≥n de citas completa
- [ ] Videoconsultas HIPAA-compliant
- [ ] Perfil de paciente b√°sico
- [ ] Dashboard de doctor funcional

### Quality Gates

- [ ] E2E tests: 16/16 passing
- [ ] Unit test coverage: ‚â•65%
- [ ] Security scan: 0 high/critical vulnerabilities
- [ ] Lighthouse Performance: ‚â•90
- [ ] Lighthouse Accessibility: 100
- [ ] Costo mensual: ‚â§$5/mes

### Documentation

- [ ] Architecture diagrams actualizados
- [ ] HIPAA compliance checklist completo
- [ ] API documentation completa
- [ ] Deployment guide actualizado

---

## üéØ M√©tricas de √âxito del MVP

### M√©tricas T√©cnicas

- ‚úÖ Costo mensual: $3.20/mes (target: <$5/mes)
- ‚úÖ Uptime: 99.5% (target: >99%)
- ‚úÖ Response time P95: <500ms (target: <1s)
- ‚úÖ Tests passing: 100% (target: 100%)

### M√©tricas de Negocio (3 meses)

- üéØ Usuarios registrados: 50-100
- üéØ Citas agendadas: 200-500
- üéØ Videoconsultas realizadas: 100-300
- üéØ Net Promoter Score: >40

### Triggers para Fase 1

- ‚úÖ 100+ usuarios activos mensuales ‚Üí Activar CMEK
- ‚úÖ 10K+ requests/d√≠a ‚Üí Activar Cloud Armor
- ‚úÖ Primeros 10 clientes pagos ‚Üí Implementar facturaci√≥n
- ‚úÖ Solicitudes de recetas ‚Üí Implementar prescriptions
- ‚úÖ NPS >50 ‚Üí Expandir features

---

## üìö Referencias

- [HIPAA Compliance Cost Analysis](./hipaa-compliance-cost-analysis.md)
- [GCP Architecture Validation](../deployment/architecture-validation.md)
- [Final Quality Report](../../FINAL_QUALITY_REPORT.md)
- [Deployment Strategy](../../DEPLOYMENT_STRATEGY.md)

---

**√öltima actualizaci√≥n**: 11 de Enero, 2025 **Pr√≥xima revisi√≥n**: Al completar
Sprint 1 **Owner**: DevOps Team + Product Owner
